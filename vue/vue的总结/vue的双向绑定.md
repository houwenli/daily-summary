# vue的双向绑定

vue是mvvm框架，双向绑定以为着 model层和view层，model层的数据发生变化就会触发view的更新，view层中通过指令修改了数据会直接体现到model层

view-model就是做这层处理，它的主要职责就是

- 监听器 对所有数据进行监听
- 解析器 对每个元素节点的指令进行跟踪和解析，根据指令更新模版，并且替换数据，并且绑定响应的跟踪函数

## 实现双向绑定

- new Vue() 时执行初始化，对data进行响应式处理，这个过程发生在Observe中
- 对模版进行编译，找到模版中定义的字段，并用data中的数据替换掉，并初始化视图，这个阶段是Compile，初始化时数据也会发生变化，所以也会调用一个主流程的update方法，渲染全部页面
- 同时定义一个更新函数和Watcher函数，将来数据变化时调用对应的更新函数
- data中的某个值可能在视图中多个地方出现，也就是说存在在多个watcher中，此时我们需要用一个dep存放watcher数组
- 数据发生变化时，我们就通过dep找到所有的watcher，然后再执行响应的更新函数

具体流程图如下
![双向绑定](./双向绑定.png)
