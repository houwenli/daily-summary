## 数据驱动
---

首先我们看一个vue的简单例子
```html
<div id="app">
    <p>{{name}}</p>
    <p>{{age}}</p>
</div>
```
```js
let app = new Vue({
    el: '#app',
    data: {
        name: 'hahhaha',
        age: 23
    }
})
```
我们在使用vue时会发现很简单的可以使用data来控制dom中的数据

假如我们不用vue想想会怎么实现呢
无非是以下几步
1、获取根节点dom元素
2、定义数据
3、遍历dom节点，用正则的方式把dom中的{{}}数据替换成data中的数据
4、用我们新的dom节点替换掉原来的dom（老的dom要保留，因为在vue中我们可能会多次操作dom）
来看看结果
```js
const root = document.getElementById('app')
let data = {
    name: 'hahah',
    age: 23
}

// 使用递归，将数据放入模板
function compiler (template, data) {
    let childNodes = template.childNodes || []
    for (let i = 0 ; i < childNodes.length; i++) {
        let nodeType = childNodes[i].nodeType; // 1是元素，3是文本
        if(nodeType == 3) {
            // 文本节点去替换掉{{}}
            let text = childNodes[i].nodeValue
            // 替换花括号
            let rkuohao = /\{\{(.+?)\}\}/g

            text = text.replace(rkuohao, function () {
                const param = arguments
                let key = param[1]
                return data[key] || ''
            })
            childNodes[i].nodeValue = text
        } else if (nodeType == 1) {
            compiler(childNodes[i], data)
        }
    }
}

const generateNode = root.cloneNode(true)
compiler(generateNode, data)

root.parentNode.replaceChild(generateNode, root)

setTimeout(() => {
    const root = document.getElementById('app')
    console.log(22222, generateNode)
})
```
